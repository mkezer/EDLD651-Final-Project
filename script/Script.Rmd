---
title             : "Relationship between social capital and election results"
shorttitle        : "Title"
author: 
      
  - name          : "Anisha Babu"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    email         : "ababu@uoregon.edu"
    role:         # Contributorship roles (e.g., CRediT, https://casrai.org/credit/)
      - Conceptualization
      - Data Analysis
      - Writing - Original Draft Preparation
      - Writing - Review & Editing
  - name          : "Hyeonjin Cha"
    affiliation   : "1"
    email         : "hcha@uoregon.edu"
    role:         # Contributorship roles (e.g., CRediT, https://casrai.org/credit/)
      - Conceptualization
      - Data Analysis
      - Writing - Original Draft Preparation
      - Writing - Review & Editing
  - name          : "Diana DeWald"
    affiliation   : "1"
    email         : "ddewald@uoregon.edu"    
    role:         # Contributorship roles (e.g., CRediT, https://casrai.org/credit/)
      - Conceptualization
      - Data Analysis
      - Writing - Original Draft Preparation
      - Writing - Review & Editing
  - name          : "Murat Kezer"
    affiliation   : "1"
    email         : "mkezer@uoregon.edu"    
    role:         # Contributorship roles (e.g., CRediT, https://casrai.org/credit/)
      - Conceptualization
      - Data Analysis
      - Writing - Original Draft Preparation
      - Writing - Review & Editing               
affiliation:
  - id            : "1"
    institution   : "University of Oregon"
authornote: |
  Add complete departmental affiliations for each author here. Each new line herein must be indented, like this line.
  Enter author note here.
abstract: |
  Social capital has been an important predictor of the U.S. presidential election results. However, previous studies conceptualizes social capital as a unidimensional construct. We argue that a multidimensional conceptualization of social capital will reveal patterns that will contribute to our understanding of social capital and its relationship with elections. In the present study, we first examine how social capital changes across years. Then, we investigate how different types of social capital (i.e., religion, civic, and labor) are associated with presidential election results across years. Social capital as a unidimensional construct was largely stable over the four time points used in this research (1997, 2005, 2009, and 2014). As such, it is unlikely that social capital has much impact on election results, as presidential winners typically alternate between the two major political parties. Moreover, our findings indicate that while an aggregate social capital negatively predicted democratic margin in the presidential elections, this was not the case when social capital was operationalized as a multidimensional construct. Therefore, future research should consider conceptualizing social capital as a construct comprised of a multitude of dimensions.
  
  
  <!-- https://tinyurl.com/ybremelq -->
keywords          : "keywords"
wordcount         : "X"
bibliography      : ["r-references.bib"]
floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : no
mask              : no
draft             : no
documentclass     : "apa6"
classoption       : "man"
output            :   
  papaja::apa6_pdf:
    citation_package: biblatex
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
library(papaja)
library(tidyverse)
library(rio)
library(here)
library(knitr)
library(janitor)
library(magrittr)
library(stringr)
library(here)
library(kableExtra)
library(corx)
library(broom)
library(sjmisc)
library(scales)
#packages required for plotting US Maps
library(usmap)
library(ggpubr)
r_refs("r-references.bib")
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed,
                      eval = TRUE,
                      echo = FALSE,
                      cache = FALSE)
```

# Introduction
  Social capital, a concept popularized in the late 20th century, describes a measure of connections among individuals within a society [@putnam2000]. This measure is largely concerned with the cultural norms, interpersonal trust, and social connections that allow individuals to act together in the pursuit of common goals (Ibid). Social capital is often conceptualized by recording the presence of businesses, institutions, etc. in counties and the fluctuations in their presence over time. These institutions include religious organizations, civic associations, and sporting clubs, among others (see “data” section below for further details). Social science literature has previously examined the relationship between aggregate social capital and political involvement in European countries [e.g., @morales2016; @jottier2012] as well as in the U.S. [@la1998].  
  More specifically, there are studies which implicate a relation between social capital and voting behavior in the 2016 presidential race [such as @lee2020]. Notably, @giuliano2020 found that the aggregate density of social capital at the county and individual levels in 2016 was negatively correlated with vote share for the republican candidate.  However, relatively little is known about how specific (non-aggregate) sectors of social capital impacted presidential races in 2000, 2008, 2012, and 2016. To that end, we set out to explore the relation between social capital in U.S. counties from 1997-2014 and voting behavior during subsequent presidential races.  

# Methods
  We report how we determined our sample size, all data exclusions (if any), all manipulations, and all measures in the study. <!-- 21-word solution (Simmons, Nelson & Simonsohn, 2012; retrieved from http://ssrn.com/abstract=2160588) -->

## Data
  The present study uses secondary datasets. First, *The production of social capital in US counties constitutes the social capital data* [@rupasingha2006]. Second, *County Presidential Election Returns 2000-2016* [@data6science] is used for presidential election results. Both datasets provide data on county level.  
  In the election data, we mainly used how many votes each political party received in each county as well as total number of votes in that election for a given county.  
  In the social capital data, we only selected the variables that were available in all time points. These variables were the number of bowling centers, civic and social associations, public golf courses, religious organizations, fitness and recreational sports centers, political organizations, professional organizations, business associations, labor organizations, and non-profit organizations. We also use the variables that indicate the population at county level, voter turnout, census response rate, and a social capital index.

## Data Preparation
  To prepare the data for analysis, we started with the election data as it is more comprehensive in terms of the number of counties. First, we selected the variables of interests. Then, we selected the election years (i.e., 2000, 2008, 2012, 2016) that match with social capital data. The name of the year variable was changed in a way that shows it is the year of election so that it is not mixed with the same year variable in social capital data. Next, we create new datasets for each presidential election we are interested in. These will be later merged with corresponding social capital data.  
  For each social capital dataset (i.e., 1997, 2005, 2009, 2014), we first added state code for some counties that do not readily contain that information. Then, we created two variables out of the area name such that we have different variables for county names and state codes. Then, we selected the relevant variables and cleaned the variable names. We only selected the variables that were available for all time points that we chose. Next, we created a year variable indicating when the data were collected.  
  Finally, we reorder the variables so that they are the same across datasets, and merged the four datasets to create one dataset that contains all of the data from each dataset.  
```{r load data}
election <- import(here("data", "countypres_2000-2016.csv")) %>% 
  clean_names() #load election results

s_capital_97 <- import(here("data", "social-capital-variables-for-1997.xlsx")) %>% 
  clean_names() #load social capital data for 1997

s_capital_05 <- import(here("data", "social-capital-variables-for-2005.xlsx")) %>% 
  clean_names() #load social capital data for 2005

s_capital_09 <- import(here("data", "social-capital-variables-for-2009.xlsx")) %>%
  clean_names() #load social capital data for 2009

s_capital_14 <- import(here("data", "social-capital-variables-spreadsheet-for-2014.xlsx")) %>% 
  clean_names()#load social capital data for 2014

```

```{r clean}
#select, filter, and clean data
##election
election %<>%
  select(-office, -version, -candidate, -state) %>% #select relevant variables
  filter(year %in% c(2000, 2008, 2012, 2016)) #select relevant years

election %<>% rename(year_elctn = year) #rename year variable for merging

elctn_00 <- election %>% filter(year_elctn == 2000) #create a df for each election of interest so that it's easier to match them with sc dfs
elctn_08 <- election %>% filter(year_elctn == 2008)
elctn_12 <- election %>% filter(year_elctn == 2012)
elctn_16 <- election %>% filter(year_elctn == 2016)

##social capital 1997
s_capital_97 %<>% #add DC's code
  mutate(
    areaname = recode(areaname, `District of Columbia` = "District of Columbia, DC")
  )

s_capital_97 %<>% #create county and state variables
  separate(areaname, c("county","state_po"), sep = ', ')

s_capital_97 %<>% #select relevant variables
  select(-fitnes97, -memspt97, -memnec97)

colnames(s_capital_97)[4:18] <- str_sub(colnames(s_capital_97)[4:18], end=-3) #remove the year from the variable names

s_capital_97 %<>% #create year variable before merging
  mutate(year_sc = 1997)

##social capital 2005
s_capital_05 %<>% #add DC's code
  mutate(
    areaname = recode(areaname, `District of Columbia` = "District of Columbia, DC") #add DC's code
  )

s_capital_05 %<>% #create county and state variables
  separate(areaname, c("county","state_po"), sep = ', ')

s_capital_05 %<>% #select relevant variables
  select(-fitns05)

colnames(s_capital_05)[4:18] <- str_sub(colnames(s_capital_05)[4:18], end=-3) #remove the year from the variable names

s_capital_05 %<>% #reorder the variables
  select(fips, county, state_po, bowl, civic, golf, relig, sport, pol, prof, bus, labor, respn, pvote, pop, nccs, assn, sk)

s_capital_05 %<>% #create year variable before merging
  mutate(year_sc = 2005)

##social capital 2009
s_capital_09 %<>% #add DC's code
  mutate(
    areaname = recode(areaname, `District of Columbia` = "District of Columbia, DC") #add DC's code
  )

s_capital_09 %<>% #create county and state variables
  separate(areaname, c("county","state_po"), sep = ', ')

s_capital_09 %<>% #select relevant variables
  select(-fitns09)

colnames(s_capital_09)[4:18] <- str_sub(colnames(s_capital_09)[4:18], end=-3) #remove the year from the variable names

s_capital_09 %<>% #reorder the variables
  select(fips, county, state_po, bowl, civic, golf, relig, sport, pol, prof, bus, labor, respn, pvote, pop, nccs, assn, sk)

s_capital_09 %<>% #create year variable before merging
  mutate(year_sc = 2009)

##social capital 2014
s_capital_14 %<>% #add DC's code
  mutate(
    county_name = recode(county_name, `Hoonah-Angoon Census Area, AK, AK` = "Hoonah-Angoon Census Area, AK") #remove the repeated state code
  )

s_capital_14 %<>% #create county and state variables
  separate(county_name, c("county","state_po"), sep = ', ') 

s_capital_14 %<>% #remove the word 'county' and keep only the name
  mutate(
    county = word(county, 1)
  )

s_capital_14 %<>% #select relevant variables
  select(-recreational2014)

colnames(s_capital_14)[4:18] <- str_sub(colnames(s_capital_14)[4:18], end=-5) #remove the year from the variable names

s_capital_14 %<>% #create year variable before merging
  mutate(year_sc = 2014)

s_capital_14 %<>% #reorder the variables
  select(fips, county, state_po, bowl = bowling, civic, golf, relig = religious, sport = sports, pol = political, prof = professional, 
         bus = business, labor, respn, pvote, pop, nccs, assn, sk, year_sc)
```

```{r merge datasets}
s_capital <- bind_rows(s_capital_97, s_capital_05, s_capital_09, s_capital_14) #merge social capital data

df_00 <- inner_join(elctn_00, s_capital_97, by = "fips") #merge election 2000 & social capital 1997
df_00 %<>% 
  select(year_elctn, year_sc, state_po = state_po.x, county = county.x, fips, party, candidatevotes, totalvotes, bowl, civic, golf, relig,
         sport, pol, prof, bus, labor, respn, pvote, pop, nccs, assn, sk) #remove duplicates, and reorder and rename variables

df_08 <- inner_join(elctn_08, s_capital_05, by = "fips") #merge election 2008 & social capital 2005
df_08 %<>% 
  select(year_elctn, year_sc, state_po = state_po.x, county = county.x, fips, party, candidatevotes, totalvotes, bowl, civic, golf, relig,
         sport, pol, prof, bus, labor, respn, pvote, pop, nccs, assn, sk) #remove duplicates, and reorder and rename variables

df_12 <- inner_join(elctn_12, s_capital_09, by = "fips") #merge election 2012 & social capital 2009
df_12 %<>% 
  select(year_elctn, year_sc, state_po = state_po.x, county = county.x, fips, party, candidatevotes, totalvotes, bowl, civic, golf, relig,
         sport, pol, prof, bus, labor, respn, pvote, pop, nccs, assn, sk) #remove duplicates, and reorder and rename variables

df_16 <- inner_join(elctn_16, s_capital_14, by = "fips") #merge election 2016 & social capital 2014
df_16 %<>% 
  select(year_elctn, year_sc, state_po = state_po.x, county = county.x, fips, party, candidatevotes, totalvotes, bowl, civic, golf, relig,
         sport, pol, prof, bus, labor, respn, pvote, pop, nccs, assn, sk) #remove duplicates, and reorder and rename variables

df <- bind_rows(df_00, df_08, df_12, df_16)

df_wide <- df %>% #wide format
pivot_wider(
    names_from = party,
    values_from = candidatevotes
  )

df_wide  %<>% #remove NA variable
  select(-`NA`)

rm(list=setdiff(ls(), c("df", "df_wide"))) #remove intermediate objects (from Chris' review)
```

## Data analysis
  First, we provide the descriptive statistics regarding election results in Table 1. Next, we visualize the distribution of the votes across U.S. Finally, we present several plots of our analyses and regression models in which elections results are predicted by an aggragate social capital variable as well as by different types of social capital.
  We used `r cite_r("r-references.bib")` for all our analyses.

```{r descriptives set up, include = FALSE}
(table_01 <- df_wide %>% 
  group_by(state_po) %>% 
  summarize(n = n(),
          m_totalvotes = mean(totalvotes),
          sd_totalvotes = sd(totalvotes),
          mean_pop = mean(pop), 
          sd_pop = sd(pop)))

(table_02 <- df %>% 
  mutate(party = fct_collapse(party, 
                                "Rep" = c("republican"), 
                                "Dem" = c("democrat"), 
                                "Green" = c("green")))  %>%
  group_by(year_elctn, party) %>% 
  summarize(n = n(),
          m_candidatevotes = mean(candidatevotes),
          sd_candidatevotes = sd(candidatevotes)))

(table_03 <- df_wide %>% 
  filter(year_elctn == 2000) %>%
  filter(state_po == "OR") %>%
   mutate(v_percent = (pvote *100)) %>%
  group_by(county, relig, civic, labor, democrat, republican) %>% 
  summarize(voter_turnout = mean(v_percent)))

(table_04 <- df_wide %>% 
  filter(year_elctn == 2016) %>%
  filter(state_po == "OR") %>%
   mutate(v_percent = (pvote *100)) %>%
  group_by(county, relig, civic, labor, democrat, republican) %>% 
  summarize(voter_turnout = mean(v_percent)))
```

## Visualization
  We sought to answer our research questions with different visualizations. First, we explored how social capital changes over the four time points in our study (1997, 2005, 2009, and 2014). Next, we explored how U.S. presidential election results over the years (2000, 2008, 2012, and 2016) change depending on social capital in the preceding years. To supplement these analyses, we also consider geographic trends for election results and social capital across the U.S. and the state of Oregon.  

# Results
  We start with a description of the presidential elections analyzed in this study, and continue with our main questions. Table 1 shows votes by candidate and year of election. Figure 1 visualizes the distributions of the votes in a U.S. map.

```{r descriptives table 1}
options(knitr.kable.NA = '--')

(table_1 <- table_02 %>% 
  kbl(col.names = c("Year", "Party", "N","Mean Candidate Votes", "SD Candidate Votes"),
      digits = 0,
      caption = "A summary table for votes by candidate and year of election.",
      align =  "c") %>%
  kable_classic(full_width = FALSE) %>% 
  footnote(footnote_as_chunk = TRUE, 
           general = "N = total number of counties in the US reporting data.")) 

```

```{r visualization election results}
#US Election Results 2016

#2000 Election Results
elec_usmap_00 <- plot_usmap(data = df_wide_00, regions = "counties", values = "dem_margin") +
  scale_fill_gradient2(low = "red", 
                       mid = "white", 
                       midpoint = 0, 
                       high = "blue", 
                       name = "2000") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2000")

#2008 Election Results
elec_usmap_08 <- plot_usmap(data = df_wide_08, regions = "states", values = "dem_margin", labels = FALSE, label_color = "BLACK") + 
  scale_fill_gradient2(low = "red", 
                       mid = "white", 
                       midpoint = 0, 
                       high = "blue", 
                       name = "2008") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2008")

#2012 Election Results 
elec_usmap_12 <- plot_usmap(data = df_wide_12, regions = "states", values = "dem_margin", labels = FALSE, label_color = "BLACK") + 
  scale_fill_gradient2(low = "red", 
                       mid = "white", 
                       midpoint = 0, 
                       high = "blue", 
                       name = "2012") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2012")

#2016 Election Results 
elec_usmap_16 <- plot_usmap(data = df_wide_16, regions = "states", values = "dem_margin", labels = FALSE, label_color = "BLACK") + 
  scale_fill_gradient2(low = "red", 
                       mid = "white", 
                       midpoint = 0, 
                       high = "blue",
                       name = "2016") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2016")

#Arrange 4 Election Maps in 1 plot
elec_usmap_all <- ggarrange(elec_usmap_00,
          elec_usmap_08,
          elec_usmap_12,
          elec_usmap_16,
          ncol = 2,
          nrow = 2)

#Annotate Combined US Election Maps
annotate_figure(elec_usmap_all,
                top = text_grob("Results of US Presential Elections", face = "bold", size = 12),
                bottom = text_grob("Red and blue colors indicate Republican and Democratic lead", hjust = 1, x = 1, face = "italic", size = 10))


#Oregon election Maps
elec_ormap_00 <- plot_usmap(data = df_wide_00, regions = "counties", include = c("OR"), values = "dem_margin", labels = FALSE) +
    scale_fill_gradient2(low = "red", 
                         mid = "white", 
                         midpoint = 0, 
                         high = "blue", 
                         name = "2000") +
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2000")

elec_ormap_08 <- plot_usmap(data = df_wide_08, regions = "counties", include = c("OR"), values = "dem_margin", labels = FALSE) +
    scale_fill_gradient2(low = "red", 
                         mid = "white", 
                         midpoint = 0, 
                         high = "blue", 
                         name = "2008") +
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") +
  labs(title = "2008")

elec_ormap_12 <- plot_usmap(data = df_wide_12, regions = "counties", include = c("OR"), values = "dem_margin", labels = FALSE) +
    scale_fill_gradient2(low = "red", 
                         mid = "white", 
                         midpoint = 0, 
                         high = "blue", 
                         name = "2012") +
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2012")

elec_ormap_16 <- plot_usmap(data = df_wide_16, regions = "counties", include = c("OR"), values = "dem_margin", labels = FALSE) +
    scale_fill_gradient2(low = "red", 
                         mid = "white", 
                         midpoint = 0, 
                         high = "blue", 
                         name = "Republican - Democrat Margin (2016)") +
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2016")

#Arrange 4 oregon Election Maps in 1 plot
elec_ormap_all <- ggarrange(elec_ormap_00,
          elec_ormap_08,
          elec_ormap_12,
          elec_ormap_16,
          ncol = 2,
          nrow = 2)

#Annotate Combined US Election Maps 
annotate_figure(elec_ormap_all,
                top = text_grob("Results of US Presential Elections in Oregon", face = "bold", size = 12),
                bottom = text_grob("Red and blue colors indicate Republican and Democratic lead", hjust = 1, x = 1, face = "italic", size = 10))
```

## How does social capital change over time?
  We first considered how social capital changes over time. To do so, we first created an ‘aggregate social capital’ variable for each state. This variable represents the sum of all social capital types (bowling, civic, golf, religion, sport, political, professional, business, and labor) across all counties in a given state. To account for differences in state population, this aggregate variable was divided by the total population.   

```{r violin}
#Scatterplot of social capital over time (individual points represent states). Line fitted to show any trends over time
aggregate_states <- df %>%
  filter((year_elctn == 2000 & party == "republican") | 
           (year_elctn == 2008 & party == "democrat") | 
           (year_elctn == 2012 & party == "democrat") | 
           (year_elctn == 2016 & party == "republican")) %>%
  mutate(aggregate_capital = select(., bowl:labor) %>% rowSums()) %>%
  group_by(state_po,year_sc) %>%
  summarize(aggregate_capital = (sum(aggregate_capital) / sum(pop)) * 1000) 
aggregate_states %>%
  ggplot(mapping=aes(x=as.character(year_sc),
                     y=aggregate_capital)) +
  geom_violin(aes(color=as.character(year_sc)),show.legend=FALSE) +
  geom_boxplot(color="gray70") +
  labs(title="Social Capital Trends in U.S. States",
       x="Year",
       y="Aggregate Social Capital")
```

Figure 2: Violin plots of aggregate social capital for each state are shown for the years: 1997, 2005, 2009, and 2014. Overlaid are boxplots representing each distribution’s minimum, maximum, medium, and first and third quartiles. Aggregate social capital variables (described above) were multiplied by 1000 to avoid small decimal values and improve readability.  

  This graph shows relatively consistent aggregate social capital over the years. It is important to note that the lower outlier in the year 1997, and the upper outliers in years 2005, 2009, and 2014 are values for Washington, D.C. Without this value, distributions would be nearly identical across all time points.  
	As a secondary measure of aggregate social capital, we considered the provided values from our dataset. These values summed all types of social capital, divided by population per 10,000, and divided by 10 (1st factor). These values were used to visualize geographic trends for social capital in the year 2014.  
	
	[insert US map 2014 social capital]
  [insert Oregon map 2014 social capital]  
  
  We next considered how specific types of social capital change over time. A regression analysis revealed religious, civic, and labor types of social capital had the greatest impact on the proportion of democratic votes in the election of XXX. As such, we focused on XXX types of social capital trends over time.
  We also considered how specific types of social capital change over time. A regression analysis revealed religious, civic, and labor types of social capital had the greatest impact on the proportion of democratic votes in the election of XXX. As such, we focused on XXX types of social capital trends over time.  

```{r scatterplot}
#Scatterplot of different types of social capital over time (individual points represent aggregate for entire country). Lines fitted for each type to show trends over time
filter_df <- df %>%
  filter((year_elctn == 2000 & party == "republican") | 
           (year_elctn == 2008 & party == "democrat") | 
           (year_elctn == 2012 & party == "democrat") | 
           (year_elctn == 2016 & party == "republican")) 
aggregate_country <- filter_df %>%
  group_by(year_sc) %>%
  summarize(bowl=sum(bowl)/sum(pop)*10000,
            civic=sum(civic)/sum(pop)*10000,
            golf=sum(golf)/sum(pop)*10000,
            relig=sum(relig)/sum(pop)*10000,
            sport=sum(sport)/sum(pop)*10000,
            pol=sum(pol)/sum(pop)*10000,
            prof=sum(prof)/sum(pop)*10000,
            bus=sum(bus)/sum(pop)*10000,
            labor=sum(labor)/sum(pop)*10000)
aggregate_country <- aggregate_country %>%
  mutate(year_sc = c(1997,2005,2009,2014)) %>%
  pivot_longer(cols=bowl:labor,names_to = "type_sc", values_to = "count")
aggregate_country %>%
  filter(type_sc == "relig" | type_sc=="labor" | type_sc=="civic") %>%
  ggplot(mapping=aes(x=as.character(year_sc),y=count,color=type_sc)) +
  geom_point(show.legend=FALSE) +
  labs(title="Changes in Social Capital in U.S.",
       x="Year",
       y="Count",
       color="Type of Capital") +
  facet_wrap(~type_sc,scales="free")
```

Figure: This graph shows XXX social capital. These values represent the sum for all states in the U.S., divided by total population.  

This set of scatter plots shows … We then explored geographic trends for specific types of social capital. Figure X-X visualizes the distribution of the specific types of social capital on the U.S. map.

```{r visualization religious capital maps}
#Religious Social Capital 
rel_usmap_00 <- plot_usmap(data = df_wide_00, regions = "counties", values = "relig") +
  scale_fill_continuous(low = "white", 
                        high = "red", 
                        ) + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2000")

rel_usmap_08 <- plot_usmap(data = df_wide_08, regions = "counties", values = "relig") +
  scale_fill_continuous(low = "white", 
                        high = "red", 
                        name = "Social Capital Index (2014)", 
                        label = scales::comma
  ) + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2008")

rel_usmap_12 <- plot_usmap(data = df_wide_12, regions = "counties", values = "relig") +
  scale_fill_continuous(low = "white", 
                        high = "red", 
                        name = "Social Capital Index (2014)", 
                        label = scales::comma
  ) + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2012")

rel_usmap_16 <- plot_usmap(data = df_wide_12, regions = "counties", values = "relig") +
  scale_fill_continuous(low = "white", 
                        high = "red", 
                        name = "Social Capital Index (2014)", 
                        label = scales::comma
  ) + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2016")


#Combine 4 US Religious Social Capital Maps in 1 plot
rel_usmap_all <- ggarrange(rel_usmap_00,
          rel_usmap_08,
          rel_usmap_12,
          rel_usmap_16,
          ncol = 2,
          nrow = 2)

#Annotate Combined US Religious Social Capital Maps 
annotate_figure(rel_usmap_all,
                top = text_grob("Distribution of Religious Social Capital in US", face = "bold", size = 12),
                bottom = text_grob("Thicker color indicates higher per capita count of religious establishments", hjust = 1, x = 1, face = "italic", size = 10))


#Oregon Religious Social Capital Maps
rel_ormap_00 <- plot_usmap(data = df_wide_00, regions = "counties", include = c("OR"), values = "relig", labels = FALSE) +
  scale_fill_gradient2(low = "white", 
                        high = "red") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2000")

rel_ormap_08 <- plot_usmap(data = df_wide_08, regions = "counties", include = c("OR"), values = "relig", labels = FALSE) +
  scale_fill_gradient2(low = "white", 
                        high = "red") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2008")

rel_ormap_12 <- plot_usmap(data = df_wide_12, regions = "counties", include = c("OR"), values = "relig", labels = FALSE) +
  scale_fill_gradient2(low = "white", 
                        high = "red") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2012")

rel_ormap_16 <- plot_usmap(data = df_wide_16, regions = "counties", include = c("OR"), values = "relig", labels = FALSE) +
  scale_fill_gradient2(low = "white", 
                        high = "red") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2016")


#Combine 4 Oregon Religious Social Capital Maps in 1 plot
rel_ormap_all <- ggarrange(rel_ormap_00,
          rel_ormap_08,
          rel_ormap_12,
          rel_ormap_16,
          ncol = 2,
          nrow = 2)

#Annotate Combined Oregon Religious Social Capital Maps 
annotate_figure(rel_ormap_all,
                top = text_grob("Distribution of Religious Social Capital in Oregon", face = "bold", size = 12),
                bottom = text_grob("Thicker color indicates higher per capita count of religious establishments", hjust = 1, x = 1, face = "italic", size = 10))


```

```{r visualization civic social capital maps}

#Civic Social Capital 
civ_usmap_00 <- plot_usmap(data = df_wide_00, regions = "counties", values = "civic") +
  scale_fill_continuous(low = "white", 
                        high = "blue", 
                        ) + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2000")

civ_usmap_08 <- plot_usmap(data = df_wide_08, regions = "counties", values = "civic") +
  scale_fill_continuous(low = "white", 
                        high = "blue", 
                        name = "Social Capital Index (2014)", 
                        label = scales::comma
  ) + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2008")

civ_usmap_12 <- plot_usmap(data = df_wide_12, regions = "counties", values = "civic") +
  scale_fill_continuous(low = "white", 
                        high = "blue", 
                        name = "Social Capital Index (2014)", 
                        label = scales::comma
  ) + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2012")

civ_usmap_16 <- plot_usmap(data = df_wide_12, regions = "counties", values = "civic") +
  scale_fill_continuous(low = "white", 
                        high = "blue", 
                        name = "Social Capital Index (2014)", 
                        label = scales::comma
  ) + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2016")


#Combine 4 US Civic Social Capital Maps in 1 plot
civ_usmap_all <- ggarrange(civ_usmap_00,
          civ_usmap_08,
          civ_usmap_12,
          civ_usmap_16,
          ncol = 2,
          nrow = 2)

#Annotate Combined US Civic  Social Capital Maps 
annotate_figure(civ_usmap_all,
                top = text_grob("Distribution of Civic Social Capital in US", face = "bold", size = 12),
                bottom = text_grob("Thicker color indicates higher per capita count of civic establishments", hjust = 1, x = 1, face = "italic", size = 10))


#Oregon Civic Social Capital Maps
civ_ormap_00 <- plot_usmap(data = df_wide_00, regions = "counties", include = c("OR"), values = "civic", labels = FALSE) +
  scale_fill_gradient2(low = "white", 
                        high = "blue") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2000")

civ_ormap_08 <- plot_usmap(data = df_wide_08, regions = "counties", include = c("OR"), values = "civic", labels = FALSE) +
  scale_fill_gradient2(low = "white", 
                        high = "blue") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2008")

civ_ormap_12 <- plot_usmap(data = df_wide_12, regions = "counties", include = c("OR"), values = "civic", labels = FALSE) +
  scale_fill_gradient2(low = "white", 
                        high = "blue") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2012")

civ_ormap_16 <- plot_usmap(data = df_wide_16, regions = "counties", include = c("OR"), values = "civic", labels = FALSE) +
  scale_fill_gradient2(low = "white", 
                        high = "blue") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2016")


#Combine 4 Oregon Civic Social Capital Maps in 1 plot
civ_ormap_all <- ggarrange(civ_ormap_00,
          civ_ormap_08,
          civ_ormap_12,
          civ_ormap_16,
          ncol = 2,
          nrow = 2)

#Annotate Combined Oregon Civic Social Capital Maps 
annotate_figure(civ_ormap_all,
                top = text_grob("Distribution of Civic Social Capital in Oregon", face = "bold", size = 12),
                bottom = text_grob("Thicker color indicates higher per capita count of civic establishments", hjust = 1, x = 1, face = "italic", size = 10))

```

```{r visualization labor social capital maps}

#Labor Social Capital 
lab_usmap_00 <- plot_usmap(data = df_wide_00, regions = "counties", values = "labor") +
  scale_fill_continuous(low = "white", 
                        high = "brown", 
                        ) + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2000")

lab_usmap_08 <- plot_usmap(data = df_wide_08, regions = "counties", values = "labor") +
  scale_fill_continuous(low = "white", 
                        high = "brown", 
                        name = "Social Capital Index (2014)", 
                        label = scales::comma
  ) + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2008")

lab_usmap_12 <- plot_usmap(data = df_wide_12, regions = "counties", values = "labor") +
  scale_fill_continuous(low = "white", 
                        high = "brown", 
                        name = "Social Capital Index (2014)", 
                        label = scales::comma
  ) + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2012")

lab_usmap_16 <- plot_usmap(data = df_wide_12, regions = "counties", values = "labor") +
  scale_fill_continuous(low = "white", 
                        high = "brown", 
                        name = "Social Capital Index (2014)", 
                        label = scales::comma
  ) + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2016")


#Combine 4 US labor Social Capital Maps in 1 plot
lab_usmap_all <- ggarrange(lab_usmap_00,
          lab_usmap_08,
          lab_usmap_12,
          lab_usmap_16,
          ncol = 2,
          nrow = 2)

#Annotate Combined US labor Social Capital Maps 
annotate_figure(lab_usmap_all,
                top = text_grob("Distribution of Labor Social Capital in US", face = "bold", size = 12),
                bottom = text_grob("Thicker color indicates higher per capita count of labor establishments", hjust = 1, x = 1, face = "italic", size = 10))


#Oregon labor Social Capital Maps
lab_ormap_00 <- plot_usmap(data = df_wide_00, regions = "counties", include = c("OR"), values = "labor", labels = FALSE) +
  scale_fill_gradient2(low = "white", 
                        high = "brown") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2000")

lab_ormap_08 <- plot_usmap(data = df_wide_08, regions = "counties", include = c("OR"), values = "labor", labels = FALSE) +
  scale_fill_gradient2(low = "white", 
                        high = "brown") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2008")

lab_ormap_12 <- plot_usmap(data = df_wide_12, regions = "counties", include = c("OR"), values = "labor", labels = FALSE) +
  scale_fill_gradient2(low = "white", 
                        high = "brown") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2012")

lab_ormap_16 <- plot_usmap(data = df_wide_16, regions = "counties", include = c("OR"), values = "labor", labels = FALSE) +
  scale_fill_gradient2(low = "white", 
                        high = "brown") + 
  theme(panel.background = element_rect(color = "black", fill = "white")) + 
  theme(legend.position = "none") + 
  labs(title = "2016")


#Combine 4 Oregon Labor Social Capital Maps in 1 plot
lab_ormap_all <- ggarrange(lab_ormap_00,
          lab_ormap_08,
          lab_ormap_12,
          lab_ormap_16,
          ncol = 2,
          nrow = 2)

#Annotate Combined Oregon Labor Social Capital Maps 
annotate_figure(lab_ormap_all,
                top = text_grob("Distribution of Labor Social Capital in Oregon", face = "bold", size = 12),
                bottom = text_grob("Thicker color indicates higher per capita count of labor establishments", hjust = 1, x = 1, face = "italic", size = 10))

```


## Relationship between social capital and election results
  Finally, we considered the relationship between social capital and election results. The below graphs show how proportion of votes for the two major parties relates to aggregate social capital in the preceding years.  

```{r scatter and line}
#Scatterplot of proportion votes for winning party by social capital for each state
aggregate_election <- df %>%
  filter(party %in% c("republican","democrat")) %>%
  mutate(aggregate_capital = select(., bowl:labor) %>% rowSums()) %>%
  group_by(state_po,year_elctn,party) %>%
  summarize(aggregate_capital=(sum(aggregate_capital) / sum(pop)) * 1000, 
            prop_votes = sum(candidatevotes) / sum(totalvotes))
aggregate_election %>%
  filter(state_po != "DC") %>%
  mutate(year_elctn = factor(year_elctn, levels = c("2000",
                                                    "2008",
                                                    "2012",
                                                    "2016"))) %>%
  mutate(year_elctn = fct_recode(year_elctn,
                                 "2000 - Republican" = "2000",
                                 "2008 - Democrat" = "2008",
                                 "2012 - Democrat" = "2012",
                                 "2016 - Republican" = "2016")) %>%
  ggplot(mapping=aes(x=aggregate_capital,y=prop_votes,color=party)) +
  geom_point(alpha=0.5) +
  geom_smooth(se=FALSE,method=lm) +
  scale_color_manual(values=c("blue4","red4")) +
  facet_wrap(~year_elctn,scales="free") +
  labs(title="Proportion Party Votes by Social Capital in U.S. States",
       x="Aggregate Social Capital",
       y="Proportion of Votes",
       color="Party")
```

Figure: This graph shows the relationship between aggregate social capital (same values as Figure 1) and proportion of votes for political parties (democrat in blue, republican in red) over the years.

  This set of plots reveals trends between aggregate social capital and proportion of political party votes. Data for Washington, D.C. was not included in these plots as it was an outlier. This figure reveals that as aggregate social capital increases, proportion of democrat votes decreases and proportion of republican votes increases.  
  
  Next, to test this relationship, we regressed democratic margin on aggregate social capital. Table 2 displays the results. Across all election years, social capital negatively predicts democratic margin, all ps < .05. In the 2012 & 2016 elections, this relationship seems to be stronger. However, this relationship is inconsistent with the theoretical view that suggests a positive relationship between social capital and democratic margin [e.g., @giuliano2020]. Therefore, we look at how different types of social capital predict democratic margin. Table 3 presents the results. Consistent with our earlier finding, religious social capital is also negatively associated with democratic margin across elections. However, we found that civic social capital is positively associated with democratic margin in all elections except for the 2000 election. In a similar vein, labor social capital has a positive and strong relationship with democratic margin across all elections.
  
```{r regression}
#create aggregate social capital per capita & democratic margin
df_wide %<>% 
  dplyr::mutate(
    aggregate_capital = rowSums(select(., bowl:labor), na.rm = T) / pop * 1000,
    dem_margin = (democrat - republican) / (democrat + republican)
  )

#democratic margin regressed on aggregate social capital across years
model_agg_00 <- lm(dem_margin ~ aggregate_capital, 
                 data = subset(df_wide, year_elctn == 2000 & state_po != "DC"))

model_agg_08 <- lm(dem_margin ~ aggregate_capital, 
                 data = subset(df_wide, year_elctn == 2008 & state_po != "DC"))

model_agg_12 <- lm(dem_margin ~ aggregate_capital, 
                 data = subset(df_wide, year_elctn == 2012 & state_po != "DC"))

model_agg_16 <- lm(dem_margin ~ aggregate_capital, 
                 data = subset(df_wide, year_elctn == 2016 & state_po != "DC"))

#create kable
model_agg_00 %<>% tidy()
model_agg_08 %<>% tidy()
model_agg_12 %<>% tidy()
model_agg_16 %<>% tidy()

model_agg <- bind_rows(model_agg_00, model_agg_08, model_agg_12, model_agg_16)

model_agg %>% 
  select(Term = term, B = estimate, SE = std.error, p = p.value) %>% 
  rec(Term, rec = "(Intercept)=Intercept; aggregate_capital = Social_Capital_(aggregate); else = copy", 
      as.num = F, append = T, suffix = "") %>% 
  mutate(p = pvalue(p, accuracy = .05)) %>% 
  kable(align = "r", digits = 2, caption = "Table 2. Democratic Margin Predicted by Aggregate Social Capital") %>% 
  kable_classic(full_width = F) %>% 
  pack_rows("2000 Election", 1,2) %>% 
  pack_rows("2008 Election", 3,4) %>% 
  pack_rows("2012 Election", 5,6) %>% 
  pack_rows("2016 Election", 7,8)
```

``` {r regression2}
# Social Capital 2014 & Election Results 2016
df_wide_16 <- df_wide %>% filter(year_elctn == 2016) #filter
  
df_wide_16 %<>% # Create democrat margin variable
  mutate(
    dem_margin = (democrat - republican) / (democrat + republican)
    )

df_wide_16 %<>% # Social capital variables with per capita measures
  mutate(bowl = bowl/pop * 1000,
         civic = civic/pop * 1000,
         golf = golf/pop * 1000,
         relig = relig/pop * 1000,
         sport = sport/pop * 1000,
         pol = pol/pop * 1000,
         prof = prof/pop * 1000,
         bus = bus/pop * 1000,
         labor = labor/pop * 1000,
         nccs = nccs /pop * 1000)

df_wide_16 %>% # correlation table
  select(Bowling = bowl, Civic = civic, Golf = golf, Religious = relig, Sport = sport, Political = pol, Professional = prof,
         Business = bus, Labor = labor, NonProfit = nccs, `Social Capital Index` = sk, -starts_with("candidate"), 
         `Democratic Margin` = dem_margin) %>% 
  corx(triangle = "lower") %>% 
  kable(align = "c", caption = "Table 3. Correlation between social capital variables (2014) and democratic margin (2016)") %>% 
  kable_classic() %>% 
  footnote("* p < .05; ** p < .01; *** p < .001", footnote_as_chunk = T)

model_2016 <- lm(dem_margin ~ relig + civic+ labor, # regression model
                 data = df_wide_16)

# Social Capital 2009 & Election Results 2012
df_wide_12 <- df_wide %>% filter(year_elctn == 2012) #filter
  
df_wide_12 %<>% # Create democrat margin variable
  mutate(
    dem_margin = (democrat - republican) / (democrat + republican)
    )

df_wide_12 %<>% # Social capital variables with per capita measures
  mutate(bowl = bowl/pop * 1000,
         civic = civic/pop * 1000,
         golf = golf/pop * 1000,
         relig = relig/pop * 1000,
         sport = sport/pop * 1000,
         pol = pol/pop * 1000,
         prof = prof/pop * 1000,
         bus = bus/pop * 1000,
         labor = labor/pop * 1000,
         nccs = nccs /pop * 1000)

df_wide_12 %>% # correlation table
  select(Bowling = bowl, Civic = civic, Golf = golf, Religious = relig, Sport = sport, Political = pol, Professional = prof,
         Business = bus, Labor = labor, NonProfit = nccs, `Social Capital Index` = sk, -starts_with("candidate"), 
         `Democratic Margin` = dem_margin) %>% 
  corx(triangle = "lower") %>% 
  kable(align = "c", caption = "Table X. Correlation between social capital variables (2009) and democratic margin (2012)") %>% 
  kable_classic() %>% 
  footnote("* p < .05; ** p < .01; *** p < .001", footnote_as_chunk = T)

model_2012 <- lm(dem_margin ~ relig + civic + labor, # regression model
                 data = df_wide_12)

# Social Capital 2005 & Election Results 2008
df_wide_08 <- df_wide %>% filter(year_elctn == 2008) #filter
  
df_wide_08 %<>% # Create democrat margin variable
  mutate(
    dem_margin = (democrat - republican) / (democrat + republican)
    )

df_wide_08 %<>% # Social capital variables with per capita measures
  mutate(bowl = bowl/pop * 1000,
         civic = civic/pop * 1000,
         golf = golf/pop * 1000,
         relig = relig/pop * 1000,
         sport = sport/pop * 1000,
         pol = pol/pop * 1000,
         prof = prof/pop * 1000,
         bus = bus/pop * 1000,
         labor = labor/pop * 1000,
         nccs = nccs /pop * 1000)

df_wide_08 %>% # correlation table
  select(Bowling = bowl, Civic = civic, Golf = golf, Religious = relig, Sport = sport, Political = pol, Professional = prof,
         Business = bus, Labor = labor, NonProfit = nccs, `Social Capital Index` = sk, -starts_with("candidate"), 
         `Democratic Margin` = dem_margin) %>% 
  corx(triangle = "lower") %>% 
  kable(align = "c", caption = "Table X. Correlation between social capital variables (2005) and democratic margin (2008)") %>% 
  kable_classic() %>% 
  footnote("* p < .05; ** p < .01; *** p < .001", footnote_as_chunk = T)

model_2008 <- lm(dem_margin ~ relig + civic + labor, # regression model
                 data = df_wide_08)

# Social Capital 1997 & Election Results 2000
df_wide_00 <- df_wide %>% filter(year_elctn == 2000) #filter
  
df_wide_00 %<>% # Create democrat margin variable
  mutate(
    dem_margin = (democrat - republican) / (democrat + republican)
    )

df_wide_00 %<>% # Social capital variables with per capita measures
  mutate(bowl = bowl/pop * 1000,
         civic = civic/pop * 1000,
         golf = golf/pop * 1000,
         relig = relig/pop * 1000,
         sport = sport/pop * 1000,
         pol = pol/pop * 1000,
         prof = prof/pop * 1000,
         bus = bus/pop * 1000,
         labor = labor/pop * 1000,
         nccs = nccs /pop * 1000)

df_wide_00 %>% # correlation table
  select(Bowling = bowl, Civic = civic, Golf = golf, Religious = relig, Sport = sport, Political = pol, Professional = prof,
         Business = bus, Labor = labor, NonProfit = nccs, `Social Capital Index` = sk, -starts_with("candidate"), 
         `Democratic Margin` = dem_margin) %>% 
  corx(triangle = "lower") %>% 
  kable(align = "c", caption = "Table X. Correlation between social capital variables (1997) and democratic margin (2000)") %>% 
  kable_classic() %>% 
  footnote("* p < .05; ** p < .01; *** p < .001", footnote_as_chunk = T)

model_2000 <- lm(dem_margin ~ relig + civic + labor, # regression model
                 data = df_wide_00)

# regression table
model_2000 %<>% tidy()
model_2000 %<>% select(Term = term, B1 = estimate, SE1 = std.error, p1 = p.value, -statistic) #tidy it

model_2008 %<>% tidy() #tidy it
model_2008 %<>% select(Term = term, B2 = estimate, SE2 = std.error, p2 = p.value, -statistic) 

model_2012 %<>% tidy() #tidy it
model_2012 %<>% select(Term = term, B3 = estimate, SE3 = std.error, p3 = p.value, -statistic) 

model_2016 %<>% tidy() #tidy it
model_2016 %<>% select(Term = term, B4 = estimate, SE4 = std.error, p4 = p.value, -statistic) 

reg_table <- cbind( #merge the model results
  model_2000,
  select(model_2008, -Term),
  select(model_2012, -Term),
  select(model_2016, -Term)
)

reg_table$Term <- rec(reg_table$Term, #recode terms
                  rec = "(Intercept) = Intercept; civic = Civic; relig = Religious; labor = Labor; else = copy", 
                  as.num = F, append = T, suffix = "")

reg_table %>% 
  mutate(
    p1 = pvalue(p1, accuracy = .05),
    p2 = pvalue(p2, accuracy = .05),
    p3 = pvalue(p3, accuracy = .05),
    p4 = pvalue(p4, accuracy = .05)
  ) %>% 
  kable(align = "c", digits = 2, #create table
     caption = "Table X. Social Capital Variables Regressed on Democratic Margin for Each Time Point",
     col.names = c("Term", "B", "SE", "p", "B", "SE", "p", "B", "SE", "p", "B", "SE", "p")) %>% 
  kable_classic(full_width = F) %>% 
  add_header_above(c(" " = 1, "2000" = 3, "2004" = 3, "2008" = 3, "2012" = 3), bold = T) %>%
  footnote("The headers indicate election years.", footnote_as_chunk = T)  
```

# Discussion
    This project sought to study trends in U.S. social capital and presidential election results. It is thought that fluctuations in social capital may inform political involvement. As such, we observed changes in social capital over time and subsequent election results for the two major political parties (democrat and republican).  
	Initial analysis considered how aggregate social capital changes over time. Aggregate capital was largely stable over the four time points used in this project (1997, 2005, 2009, and 2014). As such, it is unlikely aggregate capital has much impact on election results, as presidential winners typically alternate between the two major political parties. GEOGRAPHICAL TRENDS  
	A secondary analysis considered individual types of social capital. A regression analysis implicated LABOR, CIVIL, and RELIGION social capital as most correlated with election results. However, our analysis of these types of social capital revealed a somewhat linear decrease in labor and civil social capital, and larger fluctuations of religion social capital. As such, none of these types of social capital corresponded directly with election results in the following years. Moreover, while aggregate social capital always negatively predicted democratic margin, this was not the case for individual types of social capital. That is, religion social capital was negatively associated with democratic margin, whereas civic and labor social capital were mostly positively related to the outcome. This finding underlines the importance of investigating different types of social capital with regard to election results.  

GEOGRAPHICAL TRENDS  
	Finally, we observed the direct relationship between aggregate social capital and proportion of votes for the major political party votes. Consistent with our earlier analysis, social capital did not appear to fluctuate with winners in any of the selected presidential elections. Rather, social capital was tied to the proportion of party votes regardless of the winner. Higher social capital was associated with a lower proportion of democratic votes and a higher proportion of republican votes.  
	In summary, our analyses reveal that social capital does indeed correspond with political party votes in presidential elections. However, social capital trends over time do not appear to affect fluctuations in presidential winners. Further geographical considerations lend a more nuanced understanding of how social capital and election results are spread across the U.S. and the state of Oregon.  

\newpage

# References


\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup
